#!/usr/bin/env python

from argparse import ArgumentParser
from pathlib import Path
from PIL import ImageGrab

TYPE_MAPPING = dict(
    dashboard=(850, 800),
)


def main(target: tuple) -> None:
    # Accounts for some lost pixels at bottom of screen
    bottom_offset = 150
    display = ImageGrab.grab().size
    offset = (
        get_offset(display[0], target[0]),
        get_offset(display[1] - bottom_offset, target[1]),
    )

    region = (
        offset[0], offset[1],
        offset[0] + target[0], offset[1] + target[1],
    )
    screenshot = ImageGrab.grab(region)
    screenshot.save(Path.home().joinpath('Desktop/screenshot.png'))


def get_offset(outer: int, inner: int) -> int:
    offset = (outer - inner) / 2
    return int(offset)


if __name__ == '__main__':
    parser = ArgumentParser(description='Takes a screenshot within a region based on type')
    parser.add_argument('--type', choices=TYPE_MAPPING.keys(), default='dashboard')
    args = parser.parse_args()
    main(TYPE_MAPPING[args.type])
