#!/bin/bash

upgrade_homebrew() {
    brew bundle --no-lock --file ~/.config/homebrew/Brewfile
    brew update
    brew upgrade
}

upgrade_apt() {
    system_type=$(uname -s)
    if [[ "${system_type}" == "Linux" ]]; then
        # source $(dirname $0)/complex/wezterm.sh
        source $(dirname $0)/complex/fonts.sh
        # sudo apt --yes update
        # sudo apt --yes upgrade
    fi
}

install_asdf_tools() {
    while read line; do
        plugin=$(echo "${line}" | cut -d' ' -f1)
        asdf plugin add "${plugin}"
    done < ~/.tool-versions
    asdf install
}

install_libraries() {
    # Python
    pip install --upgrade pip
    pip install -r ~/.config/lang/python/requirements.txt

    # Rust
    cargo install aoc-cli
    cargo install --path ~/.config/weather
    asdf reshim rust

    # Node
    npm install -g pnpm
    npm install -g neovim

    # OCaml
    # https://discuss.ocaml.org/t/unable-to-install-some-packages-with-opam-on-macos/14434/6
    opam init --no
    opam update
    opam upgrade --yes
}

setup_repos() {
    /bin/bash -c $(dirname $0)/setup-repos
}

# upgrade_homebrew
upgrade_apt
# install_asdf_tools
# install_libraries
# setup_repos
